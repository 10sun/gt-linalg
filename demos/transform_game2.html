






<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
  <title>2x2 Matrix Transformations</title>

      <link rel="stylesheet" href="mathbox/mathbox.css">
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  

  <style>
      
#help-text {
    # text-align: center;
# }
.mathbox-overlays {
    pointer-events: auto;
}

  </style>

  <link rel="stylesheet" href="css/demo.css">

</head>
<body>
    

        <script src="mathbox/mathbox-bundle.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js">
        </script>
        <script src="lib/domready.js"></script>
        <script src="js/demo2.js"></script>
        <script src="lib/dat.gui.min.js"></script>
        <script src="lib/screenfull.min.js"></script>

    

    <script type="text/javascript">
        "use strict";
        DomReady.ready(function() {

        // Generated by CoffeeScript 1.12.7
var ortho, ref;

ortho = 10000;

window.are_matrices_equal = function(m1, m2) {
  var i, j;
  for (i = j = 0; j < 4; i = ++j) {
    if (Math.abs(window.matrix[i] - window.winning_matrix[i]) > 0.0001) {
      return false;
    }
  }
  return true;
};

window.matrix = [1, 0, 0, 1];

window.updateMatrix = (function(_this) {
  return function(multiplier) {
    var a, alert_str, b, c, d, matrix;
    _this.count += 1;
    matrix = _this.matrix;
    a = multiplier[0] * matrix[0] + multiplier[1] * matrix[2];
    b = multiplier[0] * matrix[1] + multiplier[1] * matrix[3];
    c = multiplier[2] * matrix[0] + multiplier[3] * matrix[2];
    d = multiplier[2] * matrix[1] + multiplier[3] * matrix[3];
    _this.matrix = [a, b, c, d];
    console.log(_this.matrix);
    if (_this.are_matrices_equal(_this.matrix, _this.winning_matrix)) {
      alert_str = "Congratulations, you completed the challege in " + _this.count + " steps!";
      console.log(_this.count, _this.min_count);
      if (_this.count > _this.min_count) {
        alert_str += "That's more than the optimal. Try again!";
      } else {
        alert_str += "That's the optimal number of moves!";
      }
      setTimeout(function() {
        return alert(alert_str, 1000);
      });
      _this.hide_buttons();
      return _this.show_challenge_picker();
    }
  };
})(this);

window.startGame = function(challenge) {
  var par;
  this.count = 0;
  this.matrix = challenge.starting_matrix;
  this.winning_matrix = challenge.winning_matrix;
  this.min_count = challenge.min_count;
  par = document.getElementById('challenge_inst');
  par.innerHTML = challenge.message;
  this.show_buttons();
  return this.hide_challenge_picker();
};

window.demo = new Demo2D({
  preload: {
    image: 'img/' + ((ref = urlParams.pic) != null ? ref : "theo2.jpg")
  },
  ortho: ortho,
  camera: {
    position: [1.1, 0, ortho],
    lookAt: [1.1, 0, 0]
  },
  vertical: 2.2
}, function() {
  var axisOpts, challenges, clipCube, fn, fn1, future_matrix, gridOpts, i, id, inverse, j, matrices, matrix, numTransforms, ref1, view1, view2;
  window.mathbox = this.mathbox;
  matrix = [1, 0, 0, 1];
  future_matrix = matrix;
  if (this.urlParams.mat != null) {
    matrix = this.urlParams.mat.split(",").map(parseFloat);
  }
  numTransforms = 3;
  if (this.urlParams.num != null) {
    numTransforms = parseInt(this.urlParams.num);
  }
  inverse = null;
  gridOpts = {
    color: 'white',
    opacity: 0.25,
    width: 1,
    zOrder: 1,
    zIndex: 1
  };
  axisOpts = {
    color: 'white',
    opacity: 0.6,
    zIndex: 1,
    zOrder: 1,
    size: 3
  };
  view1 = this.view({
    name: 'view1',
    gridOpts: gridOpts,
    axisOpts: axisOpts,
    axisLabels: false
  });
  view1.image({
    image: this.image
  }).matrix({
    width: 2,
    height: 2,
    channels: 2,
    data: [[[-10, -10], [10, -10]], [[-10, 10], [10, 10]]]
  }).surface({
    color: 'white',
    points: '<',
    map: '<<',
    fill: true,
    zOrder: 0
  });
  view2 = this.view({
    name: 'view2',
    viewOpts: {
      position: [2.2, 0, 0]
    },
    gridOpts: gridOpts,
    axisOpts: axisOpts,
    axisLabels: false
  });
  clipCube = this.clipCube(view2, {
    draw: false,
    hilite: false,
    range: 10.0,
    pass: 'view'
  });
  clipCube.clipped.transform({}, {
    matrix: function() {
      return [window.matrix[0], window.matrix[1], 0, 0, window.matrix[2], window.matrix[3], 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];
    }
  }).image({
    image: this.image
  }).matrix({
    width: 2,
    height: 2,
    channels: 2,
    data: [[[-10, -10], [10, -10]], [[-10, 10], [10, 10]]]
  }).surface({
    color: 'white',
    points: '<',
    map: '<<',
    fill: true,
    zOrder: 0
  });
  this.caption('<div id="picker_div">\n<p id="pick_inst"> Pick a challenge! </p>\n<ul id="challenge_list">\n    <li><button id="ch1">Challenge 1</button></li>\n    <li><button id="ch2">Challenge 2</button></li>\n</ul>\n</div>\n<div id="challenge_div">\n<p id="challenge_inst"> </p>\n<table id="button_table">\n    <tr>\n        <td><button type="button" id="shear_left">Shear left</button></td>\n        <td><button type="button" id="shear_right">Shear right</button></td>\n    </tr>\n    <tr>\n        <td><button type="button" id="shear_up">Shear up</button></td>\n        <td><button type="button" id="shear_down">Shear down</button></td>\n    </tr>\n\n</table>\n<p>(Reload to choose another challenge...)</p>\n</div>');
  matrices = {
    'shear_left': [1, -1, 0, 1],
    'shear_right': [1, 1, 0, 1],
    'shear_up': [1, 0, 1, 1],
    'shear_down': [1, 0, -1, 1]
  };
  challenges = [
    {
      message: 'Transform the distorted figure back to the original figure.',
      starting_matrix: [5, 4, 6, 5],
      winning_matrix: [1, 0, 0, 1],
      min_count: 6
    }, {
      message: 'Rotate the figure by 90 degrees counterclockwise.',
      starting_matrix: [1, 0, 0, 1],
      winning_matrix: [0, -1, 1, 0],
      min_count: 3
    }
  ];
  fn = function() {
    var button, ch, ii;
    ii = i;
    ch = challenges[ii - 1];
    button = document.getElementById("ch" + ii);
    return button.addEventListener('click', function() {
      return window.startGame(ch);
    });
  };
  for (i = j = 1, ref1 = challenges.length + 1; 1 <= ref1 ? j < ref1 : j > ref1; i = 1 <= ref1 ? ++j : --j) {
    fn();
  }
  fn1 = function() {
    var button, id2;
    id2 = id;
    button = document.getElementById(id2);
    return button.addEventListener('click', function() {
      return window.updateMatrix(matrices[id2]);
    });
  };
  for (id in matrices) {
    matrix = matrices[id];
    fn1();
  }
  return window.hide_buttons();
});

window.show_buttons = function() {
  var buttons;
  buttons = document.getElementById('challenge_div');
  return buttons.style.display = "block";
};

window.hide_buttons = function() {
  var buttons;
  buttons = document.getElementById('challenge_div');
  return buttons.style.display = "none";
};

window.show_challenge_picker = function() {
  var picker_div;
  picker_div = document.getElementById('picker_div');
  return picker_div.style.display = "block";
};

window.hide_challenge_picker = function() {
  var picker_div;
  picker_div = document.getElementById('picker_div');
  return picker_div.style.display = "none";
};


        });
    </script>
</body>
</html>

