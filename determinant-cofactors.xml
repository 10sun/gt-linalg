<?xml version="1.0" encoding="UTF-8"?>

<!--********************************************************************
Copyright 2017 Georgia Institute of Technology

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation.  A copy of
the license is included in gfdl.xml.
*********************************************************************-->

<section xml:id="section-determinant-cofactors">
  <title>Determinants: Cofactor expansions</title>

  <p>
    We begin by describing one formula for determinants. This definition may seem strange, and we will have to wait to see where it comes from and ho it is connected to invertibility and volumes. However, it is convenient for calculations and will be enough to kick off our study of the determinant.
  </p>

  <p>We will build up this <em>cofactor expansion</em> from the ground up in a recursive procedure. Namely, this method will say how to compute the determinant for <m>n\times n</m> matrices, <em>assuming</em> we already know how to do so for <m>(n-1)\times(n-1)</m> matrices.
  </p>

  <p>Let's start at the beginning. First, we require determinants for <m>1\times1</m> matrices. As discussed in the last section, the natural definition of the determinant in this case, which is correct one, is
  <me>\det(a)=a.</me>
  To give our general formula, we first need to give a little notation.
  </p>

  <definition xml:id="Minor-Cofactors-Defn">
    <statement>
      <p>Suppose that <m>A</m> is an <m>n\times n</m> matrix <m>A</m>.
      </p>

      <p>The <m>(i,j)</m>-th <term>minor,</term> denoted <m>A_{ij}</m>, is the determinant of the <m>(n-1)\times (n-1)</m> matrix obtained from <m>A</m> by deleting the <m>i</m>-th row and the <m>j</m>-th column.</p>

      <p>The <m>(i,j)</m>-th <term>cofactor </term>  <m>\ C_{ij}</m> is defined in terms of the minor by
      <me>C_{ij}=(-1)^{i+j}A_{ij}.</me>
      </p>
    </statement>
  </definition>

  <p>
  Note that the signs of the cofactors follow a "checkerboard pattern". Namely, the pattern of plus and minus signs in the <m>(i,j)</m>-th entry of the matrix
  <me>\mat{+ - + -; - + - +; + - + -; - + - +}</me>
  is the sign in the definition of <m>C_{ij}</m>.
  </p>

  <example xml:id="FirstMinorCofactorEx">
    <statement>
      <p>
	For
	<me>A= \mat{1 2 3;4 5 6;7 8 9},</me>
	we have
	<me>A_{23}=\det \mat{1 2;7 8} =8-14=-6.</me>
	We also find <m>C_{23}=(-1)^{2+3}(-6)=6.</m>
      </p>
    </statement>
  </example>

  <p>
    Using <xref ref="Minor-Cofactors-Defn"/>, we can describe our procedure for computing determinants as follows.
  </p>

  <algorithm>
    <title>Cofactor/Laplace expansion</title>
    <p>
      To compute the determinant of a square matrix, do the following.
      <ol>
	<li>
	  Choose any row or column of <m>A</m>.
	</li>
	<li> For each element <m>a_{ij}</m> of this row or column, compute the associated cofactor <m>C_{ij}</m>.</li>
	<li>
	  Multiply each cofactor by the associated matrix entry <m>a_{ij}</m>.
	</li>
	<li>
	  <alert>Result:</alert>  The sum of these products is <m>\det A</m>.
	</li>
      </ol>
    </p>
  </algorithm>

  <p>
    In formulas, this says that if we pick row <m>i</m> to "expand along," then the cofactor expansion formula is
    <me>\det A=\sum_{j=1}^n a_{ij}C_{ij},</me>
    where in the sum the number <m>i</m> is fixed. Similarly, if we pick column <m>j</m> to expand along, then we obtain a formula
    <me>\det A=\sum_{i=1}^n a_{ij}C_{ij}.</me>
    Note that this gives <m>2n</m> seemingly-different formulas, which all give the same number! We will see why this is true later, and simply assume this for now.
  </p>

  <p>
    Let's try this out for a general <m>2\times2</m> matrix <m>A=\mat{a b;c d}</m>.     The minors are computed in the following picture:
  </p>

  <figure>
    <caption>The minors of a <m>2\times 2</m> matrix</caption>
    <image width="75%">
      <latex-image-code><![CDATA[
\begin{tikzpicture}

  \node at (0, 0) [anchor=east] {$A_{11} = {}$};
  \matrix (a) at (0, 0) [my math matrix, anchor=west] {
    a \& b \\ c \& d \\
    };
  \node at (a.east) [anchor=west] (a22) {${} = \mat d$};

  \node at (a22.east) [anchor=west, xshift=2em] (A12) {$A_{12} = {}$};
  \matrix (b) at (A12.east) [my math matrix, anchor=west] {
    a \& b \\ c \& d \\
    };
  \node at (b.east) [anchor=west] {${} = \mat c$};

  \matrix (c) at (a.south west) [my math matrix, anchor=north west, yshift=-1em] {
    a \& b \\ c \& d \\
    };
  \node at (c.west) [anchor=east] {$A_{21} = {}$};
  \node at (c.east) [anchor=west] (a12) {${} = \mat b$};

  \node at (a12.east) [anchor=west, xshift=2em] (A22) {$A_{12} = {}$};
  \matrix (d) at (A22.east) [my math matrix, anchor=west] {
    a \& b \\ c \& d \\
    };
  \node at (d.east) [anchor=west] {${} = \mat a$};

  \begin{scope}[every node/.style={
          seq-green, draw, thick, circle, inner sep=1pt, opacity=1},
      decoration={zigzag,segment length=1.5mm}, seq-red, thick, opacity=.7,
      line join=round]
    \node[fit=(a-1-1)] {};
    \draw[decorate] (a-1-1.west) -- (a-1-2.east);
    \draw[decorate] (a-1-1.north) -- (a-2-1.south);

    \node[fit=(b-1-2)] {};
    \draw[decorate] (b-1-1.west) -- (b-1-2.east);
    \draw[decorate] (b-1-2.north) -- (b-2-2.south);

    \node[fit=(c-2-1)] {};
    \draw[decorate] (c-2-1.west) -- (c-2-2.east);
    \draw[decorate] (c-2-1.south) -- (c-1-1.north);

    \node[fit=(d-2-2)] {};
    \draw[decorate] (d-2-1.west) -- (d-2-2.east);
    \draw[decorate] (d-1-2.north) -- (d-2-2.south);
  \end{scope}

\end{tikzpicture}
      ]]>
      </latex-image-code>
    </image>
  </figure>

  <p>
    They are all just single-entry matrices. As we have seen that the determinant of a <m>1\times1</m> matrix is just the number inside of it, the cofactors are therefore
    <md>
      <mrow>C_{11} &amp;= {+\det A_{11} = d} &amp;
      C_{12} &amp;= {-\det A_{12} = -c}</mrow>
      <mrow>C_{21} &amp;= {-\det A_{21} = -b} &amp;
      C_{22} &amp;= {+\det A_{22} = a}</mrow>
    </md>
    Choosing the first row of <m>A</m> in Step 1 of the cofactor expansion algorithm (when we do this, we also say that we are <em>expanding the determinant along the first row</em>), we find that
    <me>\det A=aC_{11}+bC_{12} = ad - bc,</me>
    which is the same formula as before.
  </p>

  <p>
    Let's try the same thing on a slightly larger example.
  </p>

  <example>
    <statement>
      <p>We find the determinant of
      <me>A= \mat{2 1 3;-1 2 1;-2 2 3}.</me>
      We make the somewhat arbitrary choice to expand along the first row. We compute the minors as
      <me>A_{11} = \det\mat{2 1;2 3} \quad\quad A_{12}=\det\mat{-1 1;2 3} \quad\quad A_{13}=\det\mat{-1 2;-2 2}.</me>
      Computing these <m>2\times 2</m> determinants, we have
      <me>A_{11}=4,\quad\quad A_{12}=-1,\quad\quad A_{13}=2.</me>
      By inserting signs, we find that the cofactors are
      <me>C_{11}=A_{11}=4,\quad\quad C_{12}=-A_{12}=1,\quad\quad C_{13}=A_{13}=2.</me>
      Thus,
      <me>\det A=a_{11}C_{11}+a_{12}C_{12}+a_{13}C_{13} =2(4)+(1)+3(2)=15.</me>
    </p>
    </statement>
  </example>

  <p>
    With this method, much larger determinants are also easy to compute, especially when there are lots of zeros in a row or column. Generally speaking, it is a good idea when computing an example to try to expand along a row or column with as many zeros as possible, or at least with the smallest entries possible.
  </p>

  <example>
    <statement>
      <p>We find the determinant of
      <me>A= \mat{2 5 -3 -2;-2 -3 2 -5;1 3 -2 0;-1 6 4 0}.</me>
      We expand along the last column to find
      <me>\det A=2\det\mat{-2 -3 2;1 3 -2;-1 6 4}
      -5 \det \mat{2 5 -3;1 3 -2;-1 6 4}.</me>
      We can find these two determinants by expanding them as well. For example, expanding along the first column on the first one, we find that
      <md>
        <mrow>
          &amp; \det \mat{-2 -3 2;1 3 -2;-1 6 4}
        </mrow>
        <mrow>
          &amp; = -2 \det \mat{3 -2;6 4} -\det \mat{-3 2;6 4} -\det \mat{-3 2;3 -2}
        </mrow>
        <mrow>
          &amp; = -2 (24) -(-24) -0=-48+24+0=-24.
        </mrow>
      </md>
      Similarly, by expanding the second <m>3\times 3</m> matrix along the first column, we find that
      <md>
        <mrow>
        &amp;
        \mat{2 5 -3;1 3 -2;-1 6 4}
        = 2 \det \mat{3 -2;6 4} -\det \mat{5 -3;6 4} -\det \mat{5 -3;3 -2}
        </mrow><mrow>
        &amp; = 2(24) -(38) -(-1) = 11.
      </mrow>
      </md>
      Thus, we find that
      <me>\det A= 2(-24)-5(11)=-103.</me>
      </p>
    </statement>
  </example>

  <p>
    Although this technique works reasonably quickly in most small examples, several important questions remain:

    <ol>
      <li>
	Where do these formulas come from?
      </li>
      <li>
	How do we know that these numbers give the same answer <em>regardless</em> of which row or column we choose (that is, this method gives <m>2n</m> different expressions for the same number attached to an <m>n\times n</m> matrix, which we claim are always all equal).
      </li>
      <li>
	Why does this number have to do with invertibility?
      </li>
    </ol>
  </p>

</section>
