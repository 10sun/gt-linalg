<?xml version="1.0" encoding="UTF-8"?>
<!--********************************************************************
Copyright 2017 Georgia Institute of Technology

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation.  A copy of
the license is included in gfdl.xml.
*********************************************************************-->

<exercises>
    <exercise>
        <statement>
            <p>Explain step by step how to find the best fit line for a collection of <m>n</m> data points in <m>\R^2</m>. Why is the best fit line unique?</p>
        </statement>
    </exercise>
    <exercise>
        <statement>
            <p>Let <m>A</m> be an <m>m \times n</m> matrix and <m>b</m> is a vector in <m>\R^n</m>. Explain how to use normal equations to find the least square solutions of <m>Ax=b</m>. For which <m>A</m> is the least square solution unique?</p>
        </statement>
    </exercise>
    <exercise>
        <statement>
            <p>Let <m>A</m> be a <m>3 \times 2</m> matrix with orthogonal columns <m>v_1, v_2</m>. Explain why the least-squares solution to <m>Ax = b</m> is
                <me>\mat{\dfrac{b \cdot v_1}{v_1 \cdot v_1} ; \dfrac{b \cdot v_2}{v_2 \cdot v_2}} </me>.
            </p>
        </statement>
        <answer>
            <p>The closest output vector is <m>\hat b = proj_{\Col A}(b)</m>. Since <m>v_1 \perp v_2</m>, we can directly compute
                <me>\hat b = \frac{b \cdot v_1}{v_1 \cdot v_1}v_1 + \frac{b \cdot v_2}{v_2 \cdot v_2}v_2 = A\vec{\frac{b \cdot v_1}{v_1 \cdot v_1} \frac{b \cdot v_2}{v_2 \cdot v_2}}</me>.
                But <m>\hat b = A \hat x</m>, so we must have
                <me>
                    \hat x = \vec{\frac{b \cdot v_1}{v_1 \cdot v_1} \frac{b \cdot v_2}{v_2 \cdot v_2}}
                </me>.
            </p>
        </answer>
    </exercise>
    <exercise>
        <statement>
            <p>Suppose that your roomate Jamie is currently taking Math 1551. Jamie scored <m>72</m><percent/> on the first exam, <m>81</m><percent/> on the second exam, and <m>84</m><percent/> on the third exam. Not having taken linear algebra yet, Jamie does not know what kind of score to expect on the final exam. Luckily, you can help out.
                <ol>
                    <li>he general equation of a line in <m>\R^2</m> is <m>y = C + Dx</m>. Write down the system of linear equations in <m>C</m> and <m>D</m> that would be satisfied by a line passing through the points <m>(1,72), (2,81)</m>, and <m>(3,84)</m>, and then write down the corresponding matrix equation.</li>
                    <li>Solve the corresponding least squares problem for <m>C</m> and <m>D</m>, and use this to write down and draw the the best fit line.</li>
                    <li>What score does this line predict for the fourth (final) exam?</li>
                </ol>
            </p>
        </statement>
        <answer>
            <p>
                <ol>
                    <li>
                        If <m>y = C + Dx</m> were satisfied by all three points, then we would have
                        <md>
                            <mrow>
                                \syseq{
                                72 = C + D(1);
                                81 = C + D(2);
                                84 = C + D(3)
                                }
                                \qquad\longsquiggly{}\qquad
                                \mat{
                                1 1;
                                1 2;
                                1 3
                                }
                                \mat{
                                C; D
                                }
                                = \mat{
                                72; 81; 84
                                }
                            </mrow>
                        </md>
                    </li>
                    <li>The least squares problem is
                        <md>
                            <mrow>
                                \mat{1 1 1; 1 2 3}\mat{1 1; 1 2; 1 3}\mat{C; D} = \mat{1 1 1; 1 2 3}\mat{72;81;84}
                                \longsquiggly{}
                                \mat{3 6; 6 14} = \mat{237; 486}
                            </mrow>
                            <mrow>
                                \amat{3 6 237; 6 14 486} \longsquiggly[rref] \amat{1 0 67; 0 1 6}
                            </mrow>
                        </md>
                        Hence <m>C=67</m> and <m>D=6</m>.
                    </li>
                    <li><m>67 + 6(4) = 91</m><percent/></li>
                </ol>
            </p>
        </answer>
    </exercise>
    <exercise>
        <statement>
            <p>Consider the four points <m>(0, 0), (1, 8), (3, 8)</m> and <m>(4, 20)</m>.
                <ol>
                    <li>Find the best fit line <m>y = Ax + B</m> through these points.</li>
                    <li>Find the best fit parabola <m>y = Ax^2 + Bx + C</m> through these points.</li>
                    <li>Find the best fit cubic <m>y = Ax^3 + Bx^2 + Cx + D</m> through these points.</li>
                </ol>
            </p>
        </statement>
        <answer>
            <p>
                <ol>
                    <li>We want to find a least squares solution to the system of linear equations
                        <md>
                            <mrow>\syseq{
                                0 = A(0) + B;
                                8 = A(1) + B;
                                8 = A(3) + B;
                                20 = A(4) + B
                                }
                             \qquad\iff\qquad
                             \mat{0 1;1 1;3 1;4 1}\vec{A B} = \vec{0 8 8 20}
                            </mrow>
                        </md>
                        We compute
                        <md>
                            <mrow>
                                \mat{0 1 3 4; 1 1 1 1}\mat{0 1;1 1;3 1;4 1} = \mat{26 8; 8 4}
                            </mrow>
                            <mrow>
                                \mat{0 1 3 4;1 1 1 1}\vec{0 8 8 20} = \vec{112 36}
                            </mrow>
                            <mrow>
                                \amat{26 8 112;8 4 36} \longsquiggly[rref] \amat{1 0 4;0 1 1}
                            </mrow>
                        </md>
                        Hence the least squares solution is <m>A=4</m> and <m>B=1</m>, so the best fit line is <m>y=4x+1</m>.
                    </li>
                    <li>We want to find a least squares solution to the system of linear equations
                        <md>
                            <mrow>
                                \syseq{
                                0 = A(0^2) + B(0) + C;
                                8 = A(1^2) + B(1) + C;
                                8 = A(3^2) + B(3) + C;
                                20 = A(4^2) + B(4) + C
                                }
                                \qquad \iff \qquad
                                \mat{0 0 1;1 1 1;9 3 1;16 4 1}\vec{A B C} = \vec{0 8 8 20}
                            </mrow>
                        </md>
                        We compute
                        <md>
                            <mrow>\mat{
                                0 1 9 16;
                                0 1 3 4;
                                1 1 1 1
                                }
                                \mat{
                                0 0 1;
                                1 1 1;
                                9 3 1;
                                16 4 1
                                }
                                = 
                                \mat{
                                338 92 26;
                                92 26 8;
                                26 8 4
                                }
                            </mrow>
                            <mrow>
                                \mat{
                                0 1 9 16;
                                0 1 3 4;
                                1 1 1 1;
                                }
                                \vec{0 8 8 20}
                                =
                                \vec{400 112 36}
                            </mrow>
                            <mrow>
                                \amat{338 92 26 400;92 26 8 112;26 8 4 36} \longsquiggly[rref] \amat{1 0 0 2/3;0 1 0 4/3;0 0 1 2}
                            </mrow>
                        </md>.
                        Hence the least squares solution is <m>A=\dfrac{2}{3}, B=\dfrac{4}{3},</m> and <m>C=2</m>, so the best fit quadratic is <m>y=\dfrac{2}{3}x^2 + \dfrac{4}{3}x + 2</m>.
                    </li>
                    <li>The best fit cubic would be the cubic <m>y=\dfrac{5}{3}x^3-\dfrac{28}{3}x^2+\dfrac{47}{3}x</m>, which actually passes through all four points.</li>
                    
                </ol>
                <latex-code>
                    \begin{tikzpicture}
                    
                    \datavisualization[
                    scientific axes={clean,width=13cm,height=18cm},
                    y axis={grid, min value=-5, max value=25}, x axis=grid,
                    visualize as smooth line/.list={linear,quadratic,cubic},
                    visualize as scatter=points,
                    legend={below,rows=3},
                    linear={label in legend={text={$y=4x+1$}}, 
                    style={visualizer color=seq-green}},
                    quadratic={label in legend={text={$y=\frac23x^2+\frac43x+2$}},
                    style={visualizer color=seq-blue}},
                    cubic={label in legend={text={$y=\frac53x^3-\frac{28}3x^2+\frac{47}3x$}},
                    style={visualizer color=seq-violet}},
                    points={style={mark=*, visualizer color=black}},
                    ]
                    
                    data [set=linear, format=function] {
                    var x : interval [-1:5];
                    func y = 4*\value x + 1;
                    }
                    data [set=quadratic, format=function] {
                    var x : interval [-1:5];
                    func y = 2/3*\value x*\value x + 4/3*\value x + 2;
                    }
                    data [set=cubic, format=function] {
                    var x : interval [-.27269:4.2140];
                    func y = 5/3*\value x*\value x*\value x
                    - 28/3*\value x*\value x + 47/3*\value x;
                    }
                    data [set=points] {
                    x, y
                    0, 0
                    1, 8
                    3, 8
                    4, 20
                    };
                    
                    \end{tikzpicture}
                    
                </latex-code>
            </p>
        </answer>
    </exercise>
    <exercise>
    	<statement>
    		<p>[MIT OCW]
    			<ol>
    				<li>Suppose <m>\hat x </m> is the best least squares solution to <m>Ax=b</m> and <m>\hat y</m> is the best least squares solution to <m>Ay=c</m>.
					Does this tell you the best least squares solution <m>\hat z</m> to <m>Az=b+c</m>? If so, what is the best <m>\hat z</m> and why?</li>
					<li>If <m>Q</m> is an <m>m \times n</m> matrix, with orthonormal columns, find the best least squares solution <m>\hat x</m> to <m>Qx=b</m>.</li>
					<li>If <m>A=QR</m>, where <m>R</m> is square invertible and <m>Q</m> is the same as in (b) find the least squares solution to <m>Ax=b</m>.</li>
    			</ol>
    		</p>
    	</statement>
    	<answer>
    		<p>
    			<ol>
    				<li>Denote by <m>P</m> the projection onto the column space of <m>A</m>. We have <m>A\hat x = Pb</m> and <m>A\hat y = Pc</m>. That means, <m>A\hat x + A\hat y = Pb+Pc=P(b+c)</m>. 
    				It follows that <m>\hat x + \hat y</m> is the least squares solution for <m>A\hat z = b+c</m>.</li>
    				<li>The least squares solution can be written as <m>\hat x = (Q^T Q)\inv Q^T b</m>. As <m>Q</m> is orthonormal, <m>Q^T Q=I</m>. Therefore, <m>\hat x = Q^T b</m>. Alternatively, solving
least squares means finding a solution to <m>Q^T Q \hat x = Q^T b</m>. As <m>Q^T Q=I</m>, we see that <m>\hat x = Q^T b</m>.</li>
					<li>The least squares solution can be written as <m>\hat x = (A^T A)\inv A^T b = (R^T Q^T QR)\inv R^T Q^T b</m>. As <m>Q</m> is orthonormal, <m>Q^T Q=I</m>. Therefore, <m>\hat x = (R^T R)\inv R^T Q^T b</m>. As 
					<m>R</m> is invertible, we get <m>\hat x = (R^T R)\inv R^T Q^T b = R\inv (R^T)\inv R^T Q^T b = R\inv Q^T b</m>.</li>
    			</ol>
    		</p>
    	</answer>
    </exercise>
</exercises>
