<?xml version="1.0" encoding="UTF-8"?>
<!--********************************************************************
Copyright 2017 Georgia Institute of Technology

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation.  A copy of
the license is included in gfdl.xml.
*********************************************************************-->
<exercises>
    <exercise>
        <statement>
            <p>Let <m>P</m> be a stochastic <m>n \times n</m> matrix with positive entries. Give two methods of finding the steady state solution and discuss their computational efficiency. Give an example when <m>P</m> is stochastic, and does not have positive entries, but the steady state does not exist.</p>
        </statement>
    </exercise>
    <exercise>
        <statement>
            <p>Let <m>A</m> be a positive stochastic matrix with steady state <m>w=\vec{1/3 2/3}</m>. What does <m>A^n \vec{9 0}</m> converge to as <m>n \to \infty</m>?</p>
        </statement>
        <answer>
            <p><m>9w = \vec{3 6}</m>.</p>
        </answer>
    </exercise>
    <exercise>
        <statement>
            <p>A stochastic matrix admits a unique steady state.
                <ol>
                    <li>True</li>
                    <li>False</li>
                    <li>Maybe</li>
                </ol>
            </p>
        </statement>
        <answer>
            <p>Maybe. A positive stochastic matrix admits a unique steady state by the Perron-Frobenius theorem, but if the matrix has zero entries, then it may admit more than one steady state.</p>
        </answer>
    </exercise>
    <exercise>
        <statement>
            <p>Give an example of a <m>2 \times 2</m> real-valued matrix <m>A</m> which is positive stochastic.</p>
        </statement>
        <answer>
            <p>
                <me>A=\mat{\dfrac{1}{3} \dfrac{1}{4}; \dfrac{2}{3} \dfrac{3}{4}}</me>
            </p>
        </answer>
    </exercise>
    <exercise>
        <statement>
            <p>In any given year, <m>10</m><percent/> of city dwellers will move to the country, while <m>90</m><percent/> will stay in the city. Likewise, <m>30</m><percent/> of country dwellers will move to the city, while <m>70</m><percent/> will stay in the country.
                <ol>
                    <li>Let <m>x_n</m> be the number of people in the city in year <m>n</m>, and let <m>y_n</m> be the number of people in the country in year <m>n</m>. Find a matrix <m>A</m> such that
                        <me>A\vec{x_n y_n} = \vec{x_{n+1} y_{n+1}}</me>.
                    </li>
                    <li>
                        Compute the steady state of <m>A</m>.
                    </li>
                    <li>If the region (city plus country) starts off with <m>1,000</m> residents, about how many people will live in the city <m>100</m> years later (assuming the total population stays constant)?</li>
                </ol>
            </p>
        </statement>
    </exercise>
    <exercise>
    	<statement>
    		<p>[MIT OCW] The following matrix <m>M</m> is a Markov matrix (its columns sum to <m>1</m>):
    			<me>M=\mat{0.3 0.4 0.5; 0.3 0.4 0.3; 0.4 0.2 0.2}</me>
    			and its steady-state eigenvector (<m>\lambda = 1</m>) is
    			<me>s=\vec{7/18 1/3 5/18}</me>.
    			Multiplying a vector <m>x</m> by <m>M</m> does not change the sum of the components. That is, the sum <m>= o^T x</m>, where <m>o=\vec{1 1 1}</m>, is conserved:
    			<me>o^T Mx = o^T x = x_1 + x_2 + x_3</me>
    			for any <m>x=\vec{x_1 x_2 x_3}</m>. (The steady-state vector <m>s</m> above was normalized so that <m>o^T s =1</m>.)
    			<ol>
    				<li>If we let <m>x=\vec{2 0 0}</m>, what vector does <m>M^n x</m> approach as <m>n \to \infty</m>.</li>
    				<li>For the same <m>x</m>, in what direction does <m>(M^T)^n x</m> point as <m>n \to \infty</m>.</li>
    				<li>Multiplying <m>M^T x</m> does not conserve the sum of the components of <m>x</m>, unlike <m>Mx</m>. However, it does conserve some linear combination of the components: there is some vector <m>v \ne 0</m> such that
    					<me>v^T M^T x = v^T x</me>
    					for all <m>x</m>. What is <m>v</m>?
    				</li>
    			</ol>
    		</p>
    	</statement>
    	<answer>
    		<p>
    			<ol>
    				<li>Since this is a positive Markov matrix, all other eigenvalues have magnitude <m>\lt 1</m>, and the solution must approach a multiple of <m>s</m>. Which multiple? Well, the sum of the entries is conserved, so the sum must equal <m>o^T x = 2</m>. Hence <m>M^nx \to 2s</m>.</li>
    				<li>Similar to the previous part, except that the steady state eigenvector is <m>o</m>, since <m>M^T o = o</m> (this is just the statement that the columns of <m>M</m> sum to 1, written in matrix form). Hence 
    				<m>(M^T)^n x \to \alpha o</m> for some scalar coefficient <m>\alpha</m>.</li>
    				<li>The reason why <m>o^T Mx = o^T x</m> was simply that <m>o</m> is an eigenvector of <m>M^T</m> with eigenvalue <m>\lambda = 1</m>. Here, we need a similar eigenvector of <m>M</m>, and we have one: <m>v=s</m> (or any multiple of <m>s</m>), since <m>s^T M^T x = (Ms)^T x = s^T x</m>.</li>
    			</ol>
    		</p>
    	</answer>
    </exercise>
    <exercise>
    	<statement>
    		<p>[MIT OCW] Consider the Markov matrix <m>A=\mat{0 1/3 1/3 0; 1/2 0 1/3 1/2; 1/2 1/3 0 1/2; 0 1/3 1/3 0}</m>
    			<ol>
    				<li>Three of the eigenvalues of <m>A</m> are 1, 0, <m>1/3</m>. Find the fourth eigenvalue of <m>A</m>.</li>
    				<li>Find the determinant <m>\det(A)</m>.</li>
    				<li>Find the eigenvector of the transposed matrix <m>A^T</m> with the eigenvalue <m>\lambda_1 = 1</m>.</li>
    				<li>Find the eigenvector of the matrix <m>A</m> with the eigenvalue <m>\lambda_1 = 1</m>.</li>
    				<li>Find the limit of <m>A^k \vec{1 0 0 0} </m> as <m>k \to +\infty</m>.</li>
    			</ol>
    		</p>
    	</statement>
    	<answer>
    		<p>
    			<ol>
    				<li>Since <m>\Tr(A)=0</m> he sum of the eigenvalues are 0. Thus, the fourth eigenvalue must be <m>-2/3</m>.</li>
    				<li>The determinant is the product of the eigenvalues, which is 0.</li>
    				<li><m>\mat{1 1 1 1}A = \mat{1 1 1 1}</m> and so the eigenvector of <m>A^T</m> with eigenvalue <m>\lambda_1=1</m> is <m>\mat{1 0 0 0}^T</m>.</li>
    				<li>The Markov matrix <m>A</m> corresponds to a random walk on the graph with four nodes <m>1,2,3,4</m> connected by the edges <m>(1,2), (1,3), (2,3), (2,4), (3,4)</m>. 
    				The degree of the nodes are 2, 3, 3, 2. Thus the vector <m>\vec{2 3 3 2}</m> is an eigenvector with eigenvalue <m>\lambda_1 = 1</m>.</li>
    				<li>Let <m>v_1=\vec{2 3 3 2}</m> and let <m>v_2, v_3, v_4</m> be eigenvectors for 0, -1/3, -2/3, respectively. Then there exist <m>c_1, \cdots, c_4 \in \R</m> with
    					<me>\vec{1 0 0 0} = c_1v_1 + c_2v_2 + c_3v_3 +c_4v_4</me>
    					Thus,
    					<me>A^k \vec{1 0 0 0} = c_1v_1 + \dfrac{(-1)^k c_3}{3^k}v_3 + \dfrac{(-2)^k c_4}{3^k}v_4 \to c_1v_1 \text{ as } k \to +\infty</me> 
    					To find <m>c_1</m> we recall that <m>\mat{1 1 1 1}A = \mat{1 1 1 1}</m>. By induction we obtain
    					<me>\mat{1 1 1 1}A^k = \mat{1 1 1 1}</me>
    					and so, <me>\mat{1 1 1 1}A^k \vec{1 0 0 0} = \mat{1 1 1 1}\vec{1 0 0 0} = 1</me>.
    					Letting <m>k \to +\infty</m> we obtain
    					<me>\mat{1 1 1 1} c_1v_1 = 1</me>
    					so that <m>c_1=\dfrac{1}{(\mat{1 1 1 1}v_1)} = 1/10</m>. 
    					The answer is <m>\vec{2 3 3 2}/10</m>.
    				</li>
    			</ol>
    		</p>
    	</answer>
    </exercise>
</exercises>
